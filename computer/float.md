# 浮点数

## 十进制小数转换成二进制浮点数
步骤
- 将整数部分转换成二进制
- 将小数部分转换成二进制
- 得到完整的二进制小数
- 将二进制小数标准化
- 得到符号位（0：正数，1：负数）
- 得到指数位（单精度：8位指数，双精度：11位指数，左补零）
- 得到尾数位（单精度：23位尾数，双精度：52位尾数，右补零）
- 得到二进制浮点数

举例：十进制的 10.625 转换成二进制的单精度浮点数
- 将整数部分转换成二进制：除 2 取余法，10/2=5余0，5/2=2余1，2/2=1余0，1/2=0余1，1010
- 将小数部分转换成二进制：乘 2 取整法，0.625x2=1.25，0.25x2=0.5，0.5x2=1.0，101
- 得到完整的二进制小数：1010.101
- 将二进制小数标准化：1.010101 x 2^-3
- 得到符号位：0
- 得到指数位：移动位数 + 偏移量 = 3 + 127 = 130，转换成二进制=10000010
- 得到尾数位：01010100000000000000000
- 得到二进制浮点数：0-10000010-01010100000000000000000，即 01000001001010100000000000000000

举例：十进制的 10.625 转换成二进制的双精度浮点数
- 将整数部分转换成二进制：除 2 取余法，10/2=5余0，5/2=2余1，2/2=1余0，1/2=0余1，1010
- 将小数部分转换成二进制：乘 2 取整法，0.625x2=1.25，0.25x2=0.5，0.5x2=1.0，101
- 得到完整的二进制小数：1010.101
- 将二进制小数标准化：1.010101 x 2^-3
- 得到符号位：0
- 得到指数位：移动位数 + 偏移量 = 3 + 1023 = 1026，转换成二进制=10000000010
- 得到尾数位：0101010000000000000000000000000000000000000000000000
- 得到二进制浮点数：0-10000000010-0101010000000000000000000000000000000000000000000000，即 0100000000100101010000000000000000000000000000000000000000000000

## 二进制浮点数转换成十进制小数
步骤
- 得到符号位
- 得到尾数
- 得到基数
- 得到指数
- 通过公式【(-1) ^ 符号位 x (1 + 尾数位) x 2 ^ (指数 - 127)】计算十进制小数

浮点数的表现形式
```
± m x n^e

# ± 符号
# m 尾数
# n 基数
# e 指数
```

用单精度浮点数表示十进制数 0.75
```java
public static void main(String[] args)
{
    float f = 0.75f;
    int i = Float.floatToIntBits(f);
    StringBuilder sb = new StringBuilder(Integer.toBinaryString(i));
    for (int j = 32 - sb.length(); j > 0; j--)
    {
        sb.insert(0, "0");
    }
    char[] b = sb.toString().toCharArray();
    char[] c = new char[34];
    for (int j = 0, k = 0; j < 34; j++)
    {
        if (j == 1 || j == 10)
        {
            c[j] = '-';
        }
        else
        {
            c[j] = b[k];
            k++;
        }
    }
    System.out.println(c);
}
```

结果（小数部分用二进制表示=.11，正规化后=1.1x10^-1）
```
0-01111110-10000000000000000000000
```

得到符号部分
```
0
```

得到指数部分（指数=-1，单精度偏移量=127，指数部分=-1+127=126）
```
01111110
```

得到尾数部分
```
10000000000000000000000
```

根据 EXCESS 系统表现得到指数 e
```
e = 01111110 的十进制数 - 127 = 126 - 127 = -1
```

根据正则表达式得到尾数 m
```
m = 尾数部分 10000000000000000000000 实际上表示的二进制数转换成十进制数
  = 1.10000000000000000000000 转换成十进制数
  = (1x2的0次幂)+(1x2的-1次幂)
  = 1.5
```

得到十进制数 0.75
```
± m x n^e = + 1.5 x 2^-1
          = + 0.75
```

## 参考
[《Java开发手册》解读：大整数传输为何禁用Long类型?](https://mp.weixin.qq.com/s?__biz=MzIzOTU0NTQ0MA==&mid=2247498496&idx=1&sn=a46cd5d34f9afca3f31121fb3ac835e0)  
[【算法】解析IEEE 754 标准](https://www.cnblogs.com/HDK2016/p/10506083.html)  
[binaryconvert](https://www.binaryconvert.com/index.html)  
